{{ template "head" . }}
<style>
  .chart-container {
    position: relative;
    height: 300px;
  }

  .stat-card {
    transition: transform 0.2s ease-in-out;
  }

  .stat-card:hover {
    transform: translateY(-2px);
  }

  .absence-card {
    transition: all 0.2s ease-in-out;
    cursor: pointer;
  }

  .absence-card:hover {
    box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
    transform: translateY(-2px);
  }

  .overtime-bar {
    transition: width 0.5s ease-in-out;
  }

  .adjustment-card {
    transition: all 0.2s ease-in-out;
    cursor: pointer;
  }

  .adjustment-card:hover {
    box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
    transform: translateY(-2px);
  }
</style>

<body class="h-full bg-gray-50">
<!-- Navigation einfügen -->
{{ template "navigation" . }}

<!-- Hauptinhalt -->
<main class="py-10">
  <div class="px-4 sm:px-6 lg:px-8">
    {{if eq .userRole "user"}}
    <!-- USER DASHBOARD -->
    <div class="mb-6">
      <h1 class="text-2xl font-bold text-gray-900">Mein Dashboard</h1>
      <p class="mt-1 text-sm text-gray-500">Persönliche Übersicht</p>
    </div>

    <!-- Persönliche Statistiken -->
    <div class="grid grid-cols-1 gap-6 mb-6 lg:grid-cols-4">
      <!-- Überstunden -->
      <div class="stat-card bg-white rounded-lg shadow-md p-4">
        <div class="flex items-center justify-between">
          <div>
            <p class="text-sm text-gray-500">Überstunden-Saldo</p>
            <p class="text-2xl font-bold {{if ge .overtimeBalance 0}}text-green-600{{else}}text-red-600{{end}}">
              {{if ge .overtimeBalance 0}}+{{end}}{{printf "%.1f" .overtimeBalance}} Std
            </p>
          </div>
          <div class="p-3 rounded-full {{if ge .overtimeBalance 0}}bg-green-100{{else}}bg-red-100{{end}}">
            <svg class="h-6 w-6 {{if ge .overtimeBalance 0}}text-green-600{{else}}text-red-600{{end}}" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" />
            </svg>
          </div>
        </div>
      </div>

      <!-- Urlaubstage -->
      <div class="stat-card bg-white rounded-lg shadow-md p-4">
        <div class="flex items-center justify-between">
          <div>
            <p class="text-sm text-gray-500">Resturlaub</p>
            <p class="text-2xl font-bold text-gray-900">{{.remainingVacation}} Tage</p>
            <p class="text-xs text-gray-400">von {{.vacationDays}} Tagen</p>
          </div>
          <div class="p-3 rounded-full bg-blue-100">
            <svg class="h-6 w-6 text-blue-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" />
            </svg>
          </div>
        </div>
      </div>

      <!-- Genommener Urlaub -->
      <div class="stat-card bg-white rounded-lg shadow-md p-4">
        <div class="flex items-center justify-between">
          <div>
            <p class="text-sm text-gray-500">Genommener Urlaub</p>
            <p class="text-2xl font-bold text-gray-900">{{printf "%.0f" .usedVacationDays}} Tage</p>
            <p class="text-xs text-gray-400">dieses Jahr</p>
          </div>
          <div class="p-3 rounded-full bg-yellow-100">
            <svg class="h-6 w-6 text-yellow-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
            </svg>
          </div>
        </div>
      </div>

      <!-- Offene Anträge -->
      <div class="stat-card bg-white rounded-lg shadow-md p-4">
        <div class="flex items-center justify-between">
          <div>
            <p class="text-sm text-gray-500">Offene Anträge</p>
            <p class="text-2xl font-bold text-gray-900">{{.pendingAbsences}}</p>
          </div>
          <div class="p-3 rounded-full bg-purple-100">
            <svg class="h-6 w-6 text-purple-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" />
            </svg>
          </div>
        </div>
      </div>
    </div>

    <!-- Schnellzugriff -->
    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
      <div class="bg-white rounded-lg shadow-md p-6">
        <h3 class="text-lg font-semibold mb-4">Schnellzugriff</h3>
        <div class="space-y-3">
          <a href="/profile" class="flex items-center p-3 rounded-lg hover:bg-gray-50 transition-colors">
            <div class="p-2 bg-green-100 rounded-lg mr-3">
              <svg class="h-6 w-6 text-green-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" />
              </svg>
            </div>
            <div>
              <p class="font-medium">Mein Profil</p>
              <p class="text-sm text-gray-500">Persönliche Daten verwalten</p>
            </div>
          </a>

          <a href="/absence-overview" class="flex items-center p-3 rounded-lg hover:bg-gray-50 transition-colors">
            <div class="p-2 bg-blue-100 rounded-lg mr-3">
              <svg class="h-6 w-6 text-blue-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" />
              </svg>
            </div>
            <div>
              <p class="font-medium">Abwesenheit beantragen</p>
              <p class="text-sm text-gray-500">Urlaub oder Krankmeldung einreichen</p>
            </div>
          </a>

          <a href="/timetracking" class="flex items-center p-3 rounded-lg hover:bg-gray-50 transition-colors">
            <div class="p-2 bg-purple-100 rounded-lg mr-3">
              <svg class="h-6 w-6 text-purple-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" />
              </svg>
            </div>
            <div>
              <p class="font-medium">Zeiterfassung</p>
              <p class="text-sm text-gray-500">Arbeitszeiten eintragen</p>
            </div>
          </a>
        </div>
      </div>

      <div class="bg-white rounded-lg shadow-md p-6">
        <h3 class="text-lg font-semibold mb-4">Meine letzten Aktivitäten</h3>
        <div class="space-y-2 text-sm">
          <p class="text-gray-500">Noch keine Aktivitäten vorhanden</p>
        </div>
      </div>
    </div>

    {{else if eq .userRole "hr"}}
    <!-- HR DASHBOARD -->
    <div class="mb-6">
      <h1 class="text-2xl font-bold text-gray-900">HR Dashboard</h1>
      <p class="mt-1 text-sm text-gray-500">Personalübersicht und demografische Daten</p>
    </div>

    <!-- HR Statistiken -->
    <div class="grid grid-cols-1 gap-6 mb-6 lg:grid-cols-4">
      <!-- Gesamtmitarbeiter -->
      <div class="stat-card bg-white rounded-lg shadow-md p-4">
        <div class="flex items-center justify-between">
          <div>
            <p class="text-sm text-gray-500">Gesamtmitarbeiter</p>
            <p class="text-2xl font-bold text-gray-900">{{.totalEmployees}}</p>
          </div>
          <div class="p-3 rounded-full bg-green-100">
            <svg class="h-6 w-6 text-green-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z" />
            </svg>
          </div>
        </div>
      </div>

      <!-- Aktive Mitarbeiter -->
      <div class="stat-card bg-white rounded-lg shadow-md p-4">
        <div class="flex items-center justify-between">
          <div>
            <p class="text-sm text-gray-500">Aktive Mitarbeiter</p>
            <p class="text-2xl font-bold text-gray-900">{{.activeEmployees}}</p>
            <p class="text-xs text-gray-400">{{.onLeaveEmployees}} im Urlaub</p>
          </div>
          <div class="p-3 rounded-full bg-blue-100">
            <svg class="h-6 w-6 text-blue-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
            </svg>
          </div>
        </div>
      </div>

      <!-- Krankmeldungen -->
      <div class="stat-card bg-white rounded-lg shadow-md p-4">
        <div class="flex items-center justify-between">
          <div>
            <p class="text-sm text-gray-500">Krankmeldungen</p>
            <p class="text-2xl font-bold text-gray-900">{{.sickEmployees}}</p>
            <p class="text-xs text-gray-400">aktuell</p>
          </div>
          <div class="p-3 rounded-full bg-red-100">
            <svg class="h-6 w-6 text-red-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
            </svg>
          </div>
        </div>
      </div>

      <!-- Offene Anträge -->
      <div class="stat-card bg-white rounded-lg shadow-md p-4">
        <div class="flex items-center justify-between">
          <div>
            <p class="text-sm text-gray-500">Offene Anträge</p>
            <p class="text-2xl font-bold text-gray-900">{{.pendingAbsencesCount}}</p>
          </div>
          <div class="p-3 rounded-full bg-yellow-100">
            <svg class="h-6 w-6 text-yellow-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
            </svg>
          </div>
        </div>
      </div>

    </div>

    <!-- Abwesenheitsanträge für HR (GRID LAYOUT) -->
    <div class="bg-white rounded-lg shadow-md mb-6">
      <div class="px-6 py-3 border-b border-gray-200 flex items-center justify-between">
        <div class="flex items-center">
          <svg class="h-5 w-5 text-blue-500 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" />
          </svg>
          <h3 class="text-lg font-semibold">Offene Abwesenheitsanträge</h3>
          {{if gt .pendingAbsencesCount 0}}
          <span class="ml-2 inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800">
        {{.pendingAbsencesCount}}
      </span>
          {{end}}
        </div>
        <a href="/absence-overview" class="text-sm text-green-600 hover:text-green-700 font-medium">Alle anzeigen →</a>
      </div>

      <div class="p-4">
        {{if gt .pendingAbsencesCount 0}}
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3">
          {{range $index, $absence := .pendingAbsences}}
          {{if lt $index 12}}
          <div onclick="window.location.href='/absence-overview'" class="absence-card border border-gray-200 rounded-lg p-3 hover:border-blue-500 hover:shadow-md transition-all duration-200 cursor-pointer">
            <div class="flex items-start justify-between mb-2">
              <div class="flex items-center">
                <div class="h-6 w-6 rounded-full bg-gradient-to-br from-blue-100 to-blue-200 flex items-center justify-center text-blue-700 text-xs font-medium mr-2 flex-shrink-0">
                  {{ getInitials $absence.EmployeeName }}
                </div>
                <div class="min-w-0">
                  <p class="font-medium text-gray-900 text-sm truncate">{{$absence.EmployeeName}}</p>
                  <p class="text-xs text-gray-500">{{$absence.Department}}</p>
                </div>
              </div>
              <span class="ml-2 inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium {{if eq $absence.Type "vacation"}}bg-blue-100 text-blue-800{{else if eq $absence.Type "sick"}}bg-red-100 text-red-800{{else}}bg-yellow-100 text-yellow-800{{end}}">
              {{if eq $absence.Type "vacation"}}Urlaub{{else if eq $absence.Type "sick"}}Krank{{else}}Sonder{{end}}
              </span>
            </div>

            <div class="space-y-1 mb-2">
              <div class="flex items-center justify-between text-xs">
                <span class="text-gray-600">Zeitraum:</span>
                <span class="text-gray-900 font-medium">{{$absence.StartDate}} - {{$absence.EndDate}}</span>
              </div>
              <div class="flex items-center justify-between text-xs">
                <span class="text-gray-600">Dauer:</span>
                <span class="text-gray-900 font-semibold">{{printf "%.0f" $absence.Days}} Tage</span>
              </div>
            </div>

            {{if $absence.Reason}}
            <div class="border-t border-gray-100 pt-2">
              <p class="text-xs text-gray-600 font-medium mb-0.5">Grund:</p>
              <p class="text-xs text-gray-800 line-clamp-2">{{$absence.Reason}}</p>
            </div>
            {{end}}
          </div>
          {{end}}
          {{end}}
        </div>
        {{else}}
        <div class="text-center py-6">
          <div class="mx-auto h-12 w-12 text-gray-400 mb-3">
            <svg fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" />
            </svg>
          </div>
          <h3 class="text-sm font-medium text-gray-900">Keine offenen Abwesenheitsanträge</h3>
          <p class="text-sm text-gray-500">Alle Anträge sind bearbeitet.</p>
        </div>
        {{end}}
      </div>
    </div>

    <!-- Ausstehende Überstunden-Genehmigungen (für HR - GRID LAYOUT) -->
    <div class="bg-white rounded-lg shadow-md mb-6">
      <div class="px-6 py-3 border-b border-gray-200 flex items-center justify-between">
        <div class="flex items-center">
          <svg class="h-5 w-5 text-orange-500 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" />
          </svg>
          <h3 class="text-lg font-semibold">Ausstehende Überstunden-Genehmigungen</h3>
          {{if gt .pendingOvertimeCount 0}}
          <span class="ml-2 inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-orange-100 text-orange-800">
        {{.pendingOvertimeCount}}
      </span>
          {{end}}
        </div>
        <a href="/overtime" class="text-sm text-green-600 hover:text-green-700 font-medium">Alle anzeigen →</a>
      </div>

      <div class="p-4">
        {{if gt .pendingOvertimeCount 0}}
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3">
          {{range $index, $adjustment := .pendingOvertimeAdjustments}}
          {{if lt $index 12}}
          <div onclick="window.location.href='/overtime'" class="adjustment-card border border-gray-200 rounded-lg p-3 hover:border-orange-500 hover:shadow-md transition-all duration-200 cursor-pointer">
            <div class="flex items-start justify-between mb-2">
              <div class="flex items-center">
                <div class="h-6 w-6 rounded-full bg-gradient-to-br from-green-100 to-green-200 flex items-center justify-center text-green-700 text-xs font-medium mr-2 flex-shrink-0">
                  {{ getInitials $adjustment.EmployeeName }}
                </div>
                <div class="min-w-0">
                  <p class="font-medium text-gray-900 text-sm truncate">{{$adjustment.EmployeeName}}</p>
                  <p class="text-xs text-gray-500">{{$adjustment.Department}}</p>
                </div>
              </div>
              <span class="ml-2 inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium
                {{if eq $adjustment.Type "Korrektur"}}bg-blue-100 text-blue-800
              {{else if eq $adjustment.Type "Bonus/Ausgleich"}}bg-green-100 text-green-800
              {{else if eq $adjustment.Type "Abzug"}}bg-red-100 text-red-800
              {{else}}bg-orange-100 text-orange-800{{end}}">
              {{$adjustment.Type}}
              </span>
            </div>

            <div class="space-y-1 mb-2">
              <div class="flex items-center justify-between text-xs">
                <span class="text-gray-600">Stunden:</span>
                <span class="font-semibold {{if contains $adjustment.Hours "+"}}text-green-600{{else}}text-red-600{{end}}">
                {{$adjustment.Hours}}
                </span>
              </div>
              <div class="flex items-center justify-between text-xs">
                <span class="text-gray-600">Beantragt von:</span>
                <span class="text-gray-900 truncate">{{$adjustment.AdjusterName}}</span>
              </div>
              <div class="flex items-center justify-between text-xs">
                <span class="text-gray-600">Datum:</span>
                <span class="text-gray-500">{{$adjustment.CreatedAt}}</span>
              </div>
            </div>

            {{if $adjustment.Reason}}
            <div class="border-t border-gray-100 pt-2">
              <p class="text-xs text-gray-600 font-medium mb-0.5">Grund:</p>
              <p class="text-xs text-gray-800 line-clamp-2">{{$adjustment.Reason}}</p>
            </div>
            {{end}}
          </div>
          {{end}}
          {{end}}
        </div>
        {{else}}
        <div class="text-center py-6">
          <div class="mx-auto h-12 w-12 text-gray-400 mb-3">
            <svg fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
            </svg>
          </div>
          <h3 class="text-sm font-medium text-gray-900">Keine ausstehenden Genehmigungen</h3>
          <p class="text-sm text-gray-500">Alle Anpassungen sind bearbeitet.</p>
        </div>
        {{end}}
      </div>
    </div>

    <!-- Anstehende Weiterbildungen und Gespräche (nebeneinander) -->
    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6">
      <!-- Anstehende Weiterbildungen -->
      <div class="bg-white rounded-lg shadow-md">
        <div class="px-6 py-3 border-b border-gray-200 flex items-center justify-between">
          <div class="flex items-center">
            <svg class="h-5 w-5 text-purple-500 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253" />
            </svg>
            <h3 class="text-lg font-semibold">Anstehende Weiterbildungen</h3>
            {{if gt .upcomingTrainingsCount 0}}
            <span class="ml-2 inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-purple-100 text-purple-800">
          {{.upcomingTrainingsCount}}
        </span>
            {{end}}
          </div>
        </div>

        <div class="p-4">
          {{if gt .upcomingTrainingsCount 0}}
          <div class="space-y-3 max-h-96 overflow-y-auto">
            {{range $index, $training := .upcomingTrainings}}
            {{if lt $index 6}}
            <div class="border border-gray-200 rounded-lg p-3 hover:border-purple-500 hover:shadow-md transition-all duration-200">
              <div class="flex items-start justify-between mb-2">
                <div class="flex items-center">
                  <div class="h-6 w-6 rounded-full bg-gradient-to-br from-purple-100 to-purple-200 flex items-center justify-center text-purple-700 text-xs font-medium mr-2 flex-shrink-0">
                    {{ getInitials $training.EmployeeName }}
                  </div>
                  <div class="min-w-0">
                    <p class="font-medium text-gray-900 text-sm truncate">{{$training.EmployeeName}}</p>
                    <p class="text-xs text-gray-500">{{$training.Department}}</p>
                  </div>
                </div>
                <span class="ml-2 inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium {{if eq $training.Status "ongoing"}}bg-green-100 text-green-800{{else}}bg-purple-100 text-purple-800{{end}}">
                {{if eq $training.Status "ongoing"}}Läuft{{else}}Geplant{{end}}
                </span>
              </div>

              <div class="mb-2">
                <p class="font-medium text-sm text-gray-900 truncate">{{$training.Title}}</p>
                {{if $training.Provider}}
                <p class="text-xs text-gray-500">Anbieter: {{$training.Provider}}</p>
                {{end}}
              </div>

              <div class="space-y-1">
                <div class="flex items-center justify-between text-xs">
                  <span class="text-gray-600">Zeitraum:</span>
                  <span class="text-gray-900 font-medium">{{$training.StartDate}} - {{$training.EndDate}}</span>
                </div>
              </div>

              {{if $training.Description}}
              <div class="border-t border-gray-100 pt-2 mt-2">
                <p class="text-xs text-gray-600 line-clamp-2">{{$training.Description}}</p>
              </div>
              {{end}}
            </div>
            {{end}}
            {{end}}
          </div>
          {{else}}
          <div class="text-center py-6">
            <div class="mx-auto h-12 w-12 text-gray-400 mb-3">
              <svg fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1" d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253" />
              </svg>
            </div>
            <h3 class="text-sm font-medium text-gray-900">Keine anstehenden Weiterbildungen</h3>
            <p class="text-sm text-gray-500">Aktuell sind keine Weiterbildungen geplant.</p>
          </div>
          {{end}}
        </div>
      </div>

      <!-- Anstehende Mitarbeitergespräche -->
      <div class="bg-white rounded-lg shadow-md">
        <div class="px-6 py-3 border-b border-gray-200 flex items-center justify-between">
          <div class="flex items-center">
            <svg class="h-5 w-5 text-indigo-500 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z" />
            </svg>
            <h3 class="text-lg font-semibold">Anstehende Mitarbeitergespräche</h3>
            {{if gt .upcomingConversationsCount 0}}
            <span class="ml-2 inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-indigo-100 text-indigo-800">
          {{.upcomingConversationsCount}}
        </span>
            {{end}}
          </div>
          <a href="/upcoming-conversations" class="text-sm text-green-600 hover:text-green-700 font-medium">Alle anzeigen →</a>
        </div>

        <div class="p-4">
          {{if gt .upcomingConversationsCount 0}}
          <div class="space-y-3 max-h-96 overflow-y-auto">
            {{range $index, $conversation := .upcomingConversations}}
            {{if lt $index 6}}
            <div onclick="window.location.href='/employees/view/{{$conversation.EmployeeID}}'" class="border border-gray-200 rounded-lg p-3 hover:border-indigo-500 hover:shadow-md transition-all duration-200 cursor-pointer">
              <div class="flex items-start justify-between mb-2">
                <div class="flex items-center">
                  <div class="h-6 w-6 rounded-full bg-gradient-to-br from-indigo-100 to-indigo-200 flex items-center justify-center text-indigo-700 text-xs font-medium mr-2 flex-shrink-0">
                    {{ getInitials $conversation.EmployeeName }}
                  </div>
                  <div class="min-w-0">
                    <p class="font-medium text-gray-900 text-sm truncate">{{$conversation.EmployeeName}}</p>
                    <p class="text-xs text-gray-500">{{$conversation.Department}}</p>
                  </div>
                </div>
                <span class="ml-2 inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium
              {{if le $conversation.DaysUntil 7}}bg-red-100 text-red-800
              {{else if le $conversation.DaysUntil 14}}bg-yellow-100 text-yellow-800
              {{else}}bg-indigo-100 text-indigo-800{{end}}">
              {{if eq $conversation.DaysUntil 0}}Heute
              {{else if eq $conversation.DaysUntil 1}}Morgen
              {{else}}In {{$conversation.DaysUntil}} Tagen{{end}}
            </span>
              </div>

              <div class="mb-2">
                <p class="font-medium text-sm text-gray-900">{{$conversation.Title}}</p>
                <p class="text-xs text-gray-600">
                  <svg class="h-3 w-3 inline mr-1" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" />
                  </svg>
                  {{$conversation.Date}}
                </p>
              </div>

              {{if $conversation.Description}}
              <div class="border-t border-gray-100 pt-2">
                <p class="text-xs text-gray-600 line-clamp-2">{{$conversation.Description}}</p>
              </div>
              {{end}}
            </div>
            {{end}}
            {{end}}
          </div>
          {{else}}
          <div class="text-center py-6">
            <div class="mx-auto h-12 w-12 text-gray-400 mb-3">
              <svg fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z" />
              </svg>
            </div>
            <h3 class="text-sm font-medium text-gray-900">Keine anstehenden Gespräche</h3>
            <p class="text-sm text-gray-500">Aktuell sind keine Mitarbeitergespräche geplant.</p>
          </div>
          {{end}}
        </div>
      </div>
    </div>

    <!-- Charts für HR -->
    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
      <!-- Abteilungsverteilung -->
      <div class="bg-white rounded-lg shadow-md p-6">
        <h3 class="text-lg font-semibold mb-4">Abteilungsverteilung</h3>
        <div class="chart-container">
          <canvas id="hrDepartmentChart"></canvas>
        </div>
      </div>

      <!-- Mitarbeiterstatus -->
      <div class="bg-white rounded-lg shadow-md p-6">
        <h3 class="text-lg font-semibold mb-4">Mitarbeiterstatus</h3>
        <div class="chart-container">
          <canvas id="hrStatusChart"></canvas>
        </div>
      </div>

      <!-- Altersverteilung -->
      <div class="bg-white rounded-lg shadow-md p-6">
        <h3 class="text-lg font-semibold mb-4">Altersverteilung</h3>
        <div class="chart-container">
          <canvas id="hrAgeChart"></canvas>
        </div>
      </div>

      <!-- Krankheitsverlauf -->
      <div class="bg-white rounded-lg shadow-md p-6">
        <h3 class="text-lg font-semibold mb-4">Krankheitsverlauf (12 Monate)</h3>
        <div class="chart-container">
          <canvas id="hrSicknessChart"></canvas>
        </div>
      </div>
    </div>

    {{else}}
    <!-- ADMIN/MANAGER DASHBOARD -->
    <div class="mb-6">
      <h1 class="text-2xl font-bold text-gray-900">Management Dashboard</h1>
      <p class="mt-1 text-sm text-gray-500">Unternehmensübersicht und Kennzahlen</p>
    </div>

    <!-- Admin/Manager Statistiken -->
    <div class="grid grid-cols-1 gap-6 mb-6 lg:grid-cols-4">
      <!-- Personalkosten -->
      <div class="stat-card bg-white rounded-lg shadow-md p-4">
        <div class="flex items-center justify-between">
          <div>
            <p class="text-sm text-gray-500">Monatliche Personalkosten</p>
            <p class="text-2xl font-bold text-gray-900">€ {{.monthlyLaborCosts}}</p>
          </div>
          <div class="p-3 rounded-full bg-green-100">
            <svg class="h-6 w-6 text-green-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
            </svg>
          </div>
        </div>
      </div>

      <!-- Gesamtmitarbeiter -->
      <div class="stat-card bg-white rounded-lg shadow-md p-4">
        <div class="flex items-center justify-between">
          <div>
            <p class="text-sm text-gray-500">Gesamtmitarbeiter</p>
            <p class="text-2xl font-bold text-gray-900">{{.totalEmployees}}</p>
          </div>
          <div class="p-3 rounded-full bg-blue-100">
            <svg class="h-6 w-6 text-blue-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z" />
            </svg>
          </div>
        </div>
      </div>

      <!-- Überstunden Gesamt -->
      <div class="stat-card bg-white rounded-lg shadow-md p-4">
        <div class="flex items-center justify-between">
          <div>
            <p class="text-sm text-gray-500">Überstunden Gesamt</p>
            <p class="text-2xl font-bold {{if ge .totalOvertime 0}}text-orange-600{{else}}text-green-600{{end}}">
              {{printf "%.0f" .totalOvertime}} Std
            </p>
          </div>
          <div class="p-3 rounded-full bg-orange-100">
            <svg class="h-6 w-6 text-orange-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" />
            </svg>
          </div>
        </div>
      </div>

      <!-- Abwesenheiten heute -->
      <div class="stat-card bg-white rounded-lg shadow-md p-4">
        <div class="flex items-center justify-between">
          <div>
            <p class="text-sm text-gray-500">Abwesenheiten heute</p>
            <p class="text-2xl font-bold text-gray-900">{{add .approvedAbsencesToday .sickToday}}</p>
            <p class="text-xs text-gray-400">{{.sickToday}} krank</p>
          </div>
          <div class="p-3 rounded-full bg-red-100">
            <svg class="h-6 w-6 text-red-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.618 5.984A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z" />
            </svg>
          </div>
        </div>
      </div>
    </div>

    <!-- Abwesenheitsanträge (GRID LAYOUT) -->
    <div class="bg-white rounded-lg shadow-md mb-6">
      <div class="px-6 py-3 border-b border-gray-200 flex items-center justify-between">
        <div class="flex items-center">
          <svg class="h-5 w-5 text-blue-500 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" />
          </svg>
          <h3 class="text-lg font-semibold">Offene Abwesenheitsanträge</h3>
          {{if gt .pendingAbsencesCount 0}}
          <span class="ml-2 inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800">
            {{.pendingAbsencesCount}}
          </span>
          {{end}}
        </div>
        <a href="/absence-overview" class="text-sm text-green-600 hover:text-green-700 font-medium">Alle anzeigen →</a>
      </div>

      <div class="p-4">
        {{if gt .pendingAbsencesCount 0}}
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3">
          {{range $index, $absence := .pendingAbsences}}
          {{if lt $index 12}}
          <div onclick="window.location.href='/absence-overview'" class="absence-card border border-gray-200 rounded-lg p-3 hover:border-blue-500 hover:shadow-md transition-all duration-200 cursor-pointer">
            <div class="flex items-start justify-between mb-2">
              <div class="flex items-center">
                <div class="h-6 w-6 rounded-full bg-gradient-to-br from-blue-100 to-blue-200 flex items-center justify-center text-blue-700 text-xs font-medium mr-2 flex-shrink-0">
                  {{ getInitials $absence.EmployeeName }}
                </div>
                <div class="min-w-0">
                  <p class="font-medium text-gray-900 text-sm truncate">{{$absence.EmployeeName}}</p>
                  <p class="text-xs text-gray-500">{{$absence.Department}}</p>
                </div>
              </div>
              <span class="ml-2 inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium {{if eq $absence.Type "vacation"}}bg-blue-100 text-blue-800{{else if eq $absence.Type "sick"}}bg-red-100 text-red-800{{else}}bg-yellow-100 text-yellow-800{{end}}">
              {{if eq $absence.Type "vacation"}}Urlaub{{else if eq $absence.Type "sick"}}Krank{{else}}Sonder{{end}}
              </span>
            </div>

            <div class="space-y-1 mb-2">
              <div class="flex items-center justify-between text-xs">
                <span class="text-gray-600">Zeitraum:</span>
                <span class="text-gray-900 font-medium">{{$absence.StartDate}} - {{$absence.EndDate}}</span>
              </div>
              <div class="flex items-center justify-between text-xs">
                <span class="text-gray-600">Dauer:</span>
                <span class="text-gray-900 font-semibold">{{printf "%.0f" $absence.Days}} Tage</span>
              </div>
            </div>

            {{if $absence.Reason}}
            <div class="border-t border-gray-100 pt-2">
              <p class="text-xs text-gray-600 font-medium mb-0.5">Grund:</p>
              <p class="text-xs text-gray-800 line-clamp-2">{{$absence.Reason}}</p>
            </div>
            {{end}}

            <!-- Quick Action Buttons -->
            <div class="border-t border-gray-100 pt-2 mt-2 flex space-x-1">
              <button onclick="event.stopPropagation(); approveAbsence('{{$absence.EmployeeID}}', 'TBD_ABSENCE_ID', 'approve')"
                      class="flex-1 bg-green-50 hover:bg-green-100 text-green-700 text-xs font-medium py-1.5 px-2 rounded transition-colors">
                <svg class="h-3 w-3 inline mr-1" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
                </svg>
                Genehmigen
              </button>
              <button onclick="event.stopPropagation(); approveAbsence('{{$absence.EmployeeID}}', 'TBD_ABSENCE_ID', 'reject')"
                      class="flex-1 bg-red-50 hover:bg-red-100 text-red-700 text-xs font-medium py-1.5 px-2 rounded transition-colors">
                <svg class="h-3 w-3 inline mr-1" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
                </svg>
                Ablehnen
              </button>
            </div>
          </div>
          {{end}}
          {{end}}
        </div>
        {{else}}
        <div class="text-center py-6">
          <div class="mx-auto h-12 w-12 text-gray-400 mb-3">
            <svg fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" />
            </svg>
          </div>
          <h3 class="text-sm font-medium text-gray-900">Keine offenen Abwesenheitsanträge</h3>
          <p class="text-sm text-gray-500">Alle Anträge sind bearbeitet.</p>
        </div>
        {{end}}
      </div>
    </div>

    <!-- Ausstehende Überstunden-Genehmigungen (GRID LAYOUT) -->
    <div class="bg-white rounded-lg shadow-md mb-6">
      <div class="px-6 py-3 border-b border-gray-200 flex items-center justify-between">
        <div class="flex items-center">
          <svg class="h-5 w-5 text-orange-500 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" />
          </svg>
          <h3 class="text-lg font-semibold">Ausstehende Überstunden-Genehmigungen</h3>
          {{if gt .pendingOvertimeCount 0}}
          <span class="ml-2 inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-orange-100 text-orange-800">
            {{.pendingOvertimeCount}}
          </span>
          {{end}}
        </div>
        <a href="/overtime" class="text-sm text-green-600 hover:text-green-700 font-medium">Alle anzeigen →</a>
      </div>

      <div class="p-4">
        {{if gt .pendingOvertimeCount 0}}
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3">
          {{range $index, $adjustment := .pendingOvertimeAdjustments}}
          {{if lt $index 12}}
          <div onclick="window.location.href='/overtime'" class="adjustment-card border border-gray-200 rounded-lg p-3 hover:border-orange-500 hover:shadow-md transition-all duration-200 cursor-pointer">
            <div class="flex items-start justify-between mb-2">
              <div class="flex items-center">
                <div class="h-6 w-6 rounded-full bg-gradient-to-br from-green-100 to-green-200 flex items-center justify-center text-green-700 text-xs font-medium mr-2 flex-shrink-0">
                  {{ getInitials $adjustment.EmployeeName }}
                </div>
                <div class="min-w-0">
                  <p class="font-medium text-gray-900 text-sm truncate">{{$adjustment.EmployeeName}}</p>
                  <p class="text-xs text-gray-500">{{$adjustment.Department}}</p>
                </div>
              </div>
              <span class="ml-2 inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium
                {{if eq $adjustment.Type "Korrektur"}}bg-blue-100 text-blue-800
              {{else if eq $adjustment.Type "Bonus/Ausgleich"}}bg-green-100 text-green-800
              {{else if eq $adjustment.Type "Abzug"}}bg-red-100 text-red-800
              {{else}}bg-orange-100 text-orange-800{{end}}">
              {{$adjustment.Type}}
              </span>
            </div>

            <div class="space-y-1 mb-2">
              <div class="flex items-center justify-between text-xs">
                <span class="text-gray-600">Stunden:</span>
                <span class="font-semibold {{if contains $adjustment.Hours "+"}}text-green-600{{else}}text-red-600{{end}}">
                {{$adjustment.Hours}}
                </span>
              </div>
              <div class="flex items-center justify-between text-xs">
                <span class="text-gray-600">Beantragt von:</span>
                <span class="text-gray-900 truncate">{{$adjustment.AdjusterName}}</span>
              </div>
              <div class="flex items-center justify-between text-xs">
                <span class="text-gray-600">Datum:</span>
                <span class="text-gray-500">{{$adjustment.CreatedAt}}</span>
              </div>
            </div>

            {{if $adjustment.Reason}}
            <div class="border-t border-gray-100 pt-2">
              <p class="text-xs text-gray-600 font-medium mb-0.5">Grund:</p>
              <p class="text-xs text-gray-800 line-clamp-2">{{$adjustment.Reason}}</p>
            </div>
            {{end}}

            <!-- Quick Action Buttons -->
            <div class="border-t border-gray-100 pt-2 mt-2 flex space-x-1">
              <button onclick="event.stopPropagation(); approveAdjustment('{{$adjustment.ID}}', 'approve')"
                      class="flex-1 bg-green-50 hover:bg-green-100 text-green-700 text-xs font-medium py-1.5 px-2 rounded transition-colors">
                <svg class="h-3 w-3 inline mr-1" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
                </svg>
                Genehmigen
              </button>
              <button onclick="event.stopPropagation(); approveAdjustment('{{$adjustment.ID}}', 'reject')"
                      class="flex-1 bg-red-50 hover:bg-red-100 text-red-700 text-xs font-medium py-1.5 px-2 rounded transition-colors">
                <svg class="h-3 w-3 inline mr-1" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
                </svg>
                Ablehnen
              </button>
            </div>
          </div>
          {{end}}
          {{end}}
        </div>
        {{else}}
        <div class="text-center py-6">
          <div class="mx-auto h-12 w-12 text-gray-400 mb-3">
            <svg fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
            </svg>
          </div>
          <h3 class="text-sm font-medium text-gray-900">Keine ausstehenden Genehmigungen</h3>
          <p class="text-sm text-gray-500">Alle Anpassungen sind bearbeitet.</p>
        </div>
        {{end}}
      </div>
    </div>

    <!-- Anstehende Weiterbildungen und Gespräche (nebeneinander) -->
    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6">
      <!-- Anstehende Weiterbildungen -->
      <div class="bg-white rounded-lg shadow-md">
        <div class="px-6 py-3 border-b border-gray-200 flex items-center justify-between">
          <div class="flex items-center">
            <svg class="h-5 w-5 text-purple-500 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253" />
            </svg>
            <h3 class="text-lg font-semibold">Anstehende Weiterbildungen</h3>
            {{if gt .upcomingTrainingsCount 0}}
            <span class="ml-2 inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-purple-100 text-purple-800">
          {{.upcomingTrainingsCount}}
        </span>
            {{end}}
          </div>
        </div>

        <div class="p-4">
          {{if gt .upcomingTrainingsCount 0}}
          <div class="space-y-3 max-h-96 overflow-y-auto">
            {{range $index, $training := .upcomingTrainings}}
            {{if lt $index 6}}
            <div class="border border-gray-200 rounded-lg p-3 hover:border-purple-500 hover:shadow-md transition-all duration-200">
              <div class="flex items-start justify-between mb-2">
                <div class="flex items-center">
                  <div class="h-6 w-6 rounded-full bg-gradient-to-br from-purple-100 to-purple-200 flex items-center justify-center text-purple-700 text-xs font-medium mr-2 flex-shrink-0">
                    {{ getInitials $training.EmployeeName }}
                  </div>
                  <div class="min-w-0">
                    <p class="font-medium text-gray-900 text-sm truncate">{{$training.EmployeeName}}</p>
                    <p class="text-xs text-gray-500">{{$training.Department}}</p>
                  </div>
                </div>
                <span class="ml-2 inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium {{if eq $training.Status "ongoing"}}bg-green-100 text-green-800{{else}}bg-purple-100 text-purple-800{{end}}">
                {{if eq $training.Status "ongoing"}}Läuft{{else}}Geplant{{end}}
                </span>
              </div>

              <div class="mb-2">
                <p class="font-medium text-sm text-gray-900 truncate">{{$training.Title}}</p>
                {{if $training.Provider}}
                <p class="text-xs text-gray-500">Anbieter: {{$training.Provider}}</p>
                {{end}}
              </div>

              <div class="space-y-1">
                <div class="flex items-center justify-between text-xs">
                  <span class="text-gray-600">Zeitraum:</span>
                  <span class="text-gray-900 font-medium">{{$training.StartDate}} - {{$training.EndDate}}</span>
                </div>
              </div>

              {{if $training.Description}}
              <div class="border-t border-gray-100 pt-2 mt-2">
                <p class="text-xs text-gray-600 line-clamp-2">{{$training.Description}}</p>
              </div>
              {{end}}
            </div>
            {{end}}
            {{end}}
          </div>
          {{else}}
          <div class="text-center py-6">
            <div class="mx-auto h-12 w-12 text-gray-400 mb-3">
              <svg fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1" d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253" />
              </svg>
            </div>
            <h3 class="text-sm font-medium text-gray-900">Keine anstehenden Weiterbildungen</h3>
            <p class="text-sm text-gray-500">Aktuell sind keine Weiterbildungen geplant.</p>
          </div>
          {{end}}
        </div>
      </div>

      <!-- Anstehende Mitarbeitergespräche -->
      <div class="bg-white rounded-lg shadow-md">
        <div class="px-6 py-3 border-b border-gray-200 flex items-center justify-between">
          <div class="flex items-center">
            <svg class="h-5 w-5 text-indigo-500 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z" />
            </svg>
            <h3 class="text-lg font-semibold">Anstehende Mitarbeitergespräche</h3>
            {{if gt .upcomingConversationsCount 0}}
            <span class="ml-2 inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-indigo-100 text-indigo-800">
          {{.upcomingConversationsCount}}
        </span>
            {{end}}
          </div>
          <a href="/upcoming-conversations" class="text-sm text-green-600 hover:text-green-700 font-medium">Alle anzeigen →</a>
        </div>

        <div class="p-4">
          {{if gt .upcomingConversationsCount 0}}
          <div class="space-y-3 max-h-96 overflow-y-auto">
            {{range $index, $conversation := .upcomingConversations}}
            {{if lt $index 6}}
            <div onclick="window.location.href='/employees/view/{{$conversation.EmployeeID}}'" class="border border-gray-200 rounded-lg p-3 hover:border-indigo-500 hover:shadow-md transition-all duration-200 cursor-pointer">
              <div class="flex items-start justify-between mb-2">
                <div class="flex items-center">
                  <div class="h-6 w-6 rounded-full bg-gradient-to-br from-indigo-100 to-indigo-200 flex items-center justify-center text-indigo-700 text-xs font-medium mr-2 flex-shrink-0">
                    {{ getInitials $conversation.EmployeeName }}
                  </div>
                  <div class="min-w-0">
                    <p class="font-medium text-gray-900 text-sm truncate">{{$conversation.EmployeeName}}</p>
                    <p class="text-xs text-gray-500">{{$conversation.Department}}</p>
                  </div>
                </div>
                <span class="ml-2 inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium
              {{if le $conversation.DaysUntil 7}}bg-red-100 text-red-800
              {{else if le $conversation.DaysUntil 14}}bg-yellow-100 text-yellow-800
              {{else}}bg-indigo-100 text-indigo-800{{end}}">
              {{if eq $conversation.DaysUntil 0}}Heute
              {{else if eq $conversation.DaysUntil 1}}Morgen
              {{else}}In {{$conversation.DaysUntil}} Tagen{{end}}
            </span>
              </div>

              <div class="mb-2">
                <p class="font-medium text-sm text-gray-900">{{$conversation.Title}}</p>
                <p class="text-xs text-gray-600">
                  <svg class="h-3 w-3 inline mr-1" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" />
                  </svg>
                  {{$conversation.Date}}
                </p>
              </div>

              {{if $conversation.Description}}
              <div class="border-t border-gray-100 pt-2">
                <p class="text-xs text-gray-600 line-clamp-2">{{$conversation.Description}}</p>
              </div>
              {{end}}
            </div>
            {{end}}
            {{end}}
          </div>
          {{else}}
          <div class="text-center py-6">
            <div class="mx-auto h-12 w-12 text-gray-400 mb-3">
              <svg fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z" />
              </svg>
            </div>
            <h3 class="text-sm font-medium text-gray-900">Keine anstehenden Gespräche</h3>
            <p class="text-sm text-gray-500">Aktuell sind keine Mitarbeitergespräche geplant.</p>
          </div>
          {{end}}
        </div>
      </div>
    </div>

    <!-- Charts für Admin/Manager -->
    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
      <!-- Personalkosten Verlauf -->
      <div class="bg-white rounded-lg shadow-md p-6">
        <h3 class="text-lg font-semibold mb-4">Personalkosten-Entwicklung</h3>
        <div class="chart-container">
          <canvas id="adminLaborCostsChart"></canvas>
        </div>
      </div>

      <!-- Überstunden Verlauf -->
      <div class="bg-white rounded-lg shadow-md p-6">
        <h3 class="text-lg font-semibold mb-4">Überstunden-Entwicklung</h3>
        <div class="chart-container">
          <canvas id="adminOvertimeChart"></canvas>
        </div>
      </div>

      <!-- Krankheitsverlauf -->
      <div class="bg-white rounded-lg shadow-md p-6">
        <h3 class="text-lg font-semibold mb-4">Krankheitsverlauf (12 Monate)</h3>
        <div class="chart-container">
          <canvas id="adminSicknessChart"></canvas>
        </div>
      </div>

      <!-- Abteilungsverteilung -->
      <div class="bg-white rounded-lg shadow-md p-6">
        <h3 class="text-lg font-semibold mb-4">Mitarbeiter nach Abteilung</h3>
        <div class="chart-container">
          <canvas id="adminDepartmentChart"></canvas>
        </div>
      </div>
    </div>

    <!-- Top Überstunden Mitarbeiter -->
    <div class="mt-6 bg-white rounded-lg shadow-md">
      <div class="px-6 py-4 border-b border-gray-200">
        <h3 class="text-lg font-semibold">Top 10 Überstunden-Mitarbeiter</h3>
      </div>
      <div class="p-6">
        {{if .overtimeEmployees}}
        <div class="space-y-3">
          {{range .overtimeEmployees}}
          <div class="flex items-center justify-between p-3 rounded-lg hover:bg-gray-50">
            <div class="flex items-center">
              <div class="h-8 w-8 rounded-full bg-gradient-to-br from-blue-100 to-blue-200 flex items-center justify-center text-blue-700 text-xs font-medium mr-3">
                {{ getInitials .Name }}
              </div>
              <span class="text-sm font-medium text-gray-900">{{.Name}}</span>
            </div>
            <div class="flex items-center">
              <span class="text-sm font-semibold {{if eq .Status "positive"}}text-orange-600{{else if eq .Status "negative"}}text-green-600{{else}}text-gray-600{{end}}">
              {{if ge .Balance 0}}+{{end}}{{printf "%.1f" .Balance}} Std
              </span>
              <div class="ml-3 w-24">
                <div class="w-full bg-gray-200 rounded-full h-2">
                  <div class="h-2 rounded-full {{if eq .Status "positive"}}bg-orange-500{{else if eq .Status "negative"}}bg-green-500{{else}}bg-gray-500{{end}}"
                  style="width: {{if gt (abs .Balance) 100}}100{{else}}{{abs .Balance}}{{end}}%"></div>
              </div>
            </div>
          </div>
        </div>
        {{end}}
      </div>
      {{else}}
      <p class="text-center text-gray-500">Keine Überstunden-Daten verfügbar</p>
      {{end}}
    </div>
  </div>

  {{end}}

  <!-- Letzte Aktivitäten (für alle außer User) -->
  {{if ne .userRole "user"}}
  <div class="mt-6 bg-white rounded-lg shadow-md">
    <div class="px-6 py-4 border-b border-gray-200">
      <h3 class="text-lg font-semibold">Letzte Aktivitäten</h3>
    </div>
    <div class="p-6">
      <div class="flow-root">
        <ul class="-mb-8">
          {{range .recentActivities}}
          <li>
            <div class="relative pb-8">
              {{if not .IsLast}}
              <span class="absolute top-4 left-4 -ml-px h-full w-0.5 bg-gray-200" aria-hidden="true"></span>
              {{end}}
              <div class="relative flex space-x-3">
                <div>
                    <span class="h-8 w-8 rounded-full {{.IconBgClass}} flex items-center justify-center ring-8 ring-white">
                      {{.IconSVG | safeHTML}}
                    </span>
                </div>
                <div class="min-w-0 flex-1">
                  <div>
                    <div class="text-sm text-gray-500">
                      {{.Message | safeHTML}}
                    </div>
                    <p class="mt-0.5 text-sm text-gray-500">{{.Time}}</p>
                  </div>
                </div>
              </div>
            </div>
          </li>
          {{else}}
          <li class="text-center text-gray-500 py-2">
            Keine Aktivitäten gefunden
          </li>
          {{end}}
        </ul>
      </div>
    </div>
  </div>
  {{end}}
  </div>
</main>

<!-- Footer -->
{{ template "footer" . }}

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
  document.addEventListener('DOMContentLoaded', function() {
    // Einheitliche Farbpalette definieren (NUR GRÜNTÖNE)
    const globalChartColors = {
      darkestGreen: '#05402D',  // Sehr dunkles Grün
      darkGreen: '#15803D',     // Dunkelgrün
      mediumGreen: '#22C55E',   // Mittleres Grün
      lightGreen: '#86EFAC',    // Helles Grün
      limeGreen: '#C3E657',     // Gelbgrün / Limettengrün (als hellste Variante)
      // Hilfs-Array für zyklische Farbverwendung
      paletteCycle: ['#05402D', '#15803D', '#22C55E', '#86EFAC', '#C3E657']
    };

    // Helper Funktion für Währungsformatierung
    function formatCurrency(value) {
      return new Intl.NumberFormat('de-DE', { style: 'currency', currency: 'EUR' }).format(value);
    }

    // Validierungsfunktion für Chart-Daten
    function isValidChartData(labels, data) {
      return labels && data &&
              Array.isArray(labels) && Array.isArray(data) &&
              labels.length > 0 && data.length > 0 &&
              labels.length === data.length;
    }

    // --- BEGINN: Nur für Admin/Manager Rollen (nicht HR) ---
    {{if and (ne .userRole "user") (ne .userRole "hr")}}

    // Personalkosten-Diagramm
    const adminLaborCtx = document.getElementById('adminLaborCostsChart');
    if (adminLaborCtx) {
      const monthLabels = {{.monthLabels}} || ['Jan', 'Feb', 'Mär', 'Apr', 'Mai', 'Jun', 'Jul', 'Aug', 'Sep', 'Okt', 'Nov', 'Dez'];
      const costsData = {{.monthlyCostsData}} || [];

      if (costsData.length > 0) {
        new Chart(adminLaborCtx.getContext('2d'), {
          type: 'line',
          data: {
            labels: monthLabels,
            datasets: [{
              label: 'Personalkosten (€)',
              data: costsData,
              borderColor: globalChartColors.darkGreen,
              backgroundColor: `${globalChartColors.darkGreen}33`,
              fill: true,
              tension: 0.4
            }]
          },
          options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
              tooltip: {
                callbacks: {
                  label: function(context) {
                    return 'Personalkosten: ' + formatCurrency(context.parsed.y);
                  }
                }
              },
              legend: { position: 'top' }
            },
            scales: {
              x: { grid: { display: false } },
              y: {
                beginAtZero: true,
                ticks: {
                  callback: function(value) {
                    return formatCurrency(value);
                  }
                }
              }
            }
          }
        });
      }
    }

    // Überstunden Verlauf
    const adminOvertimeCtx = document.getElementById('adminOvertimeChart');
    if (adminOvertimeCtx) {
      const monthLabels = {{.monthLabels}} || ['Jan', 'Feb', 'Mär', 'Apr', 'Mai', 'Jun', 'Jul', 'Aug', 'Sep', 'Okt', 'Nov', 'Dez'];
      const overtimeData = {{.overtimeTrend}} || [];

      if (overtimeData.length > 0) {
        new Chart(adminOvertimeCtx.getContext('2d'), {
          type: 'line',
          data: {
            labels: monthLabels,
            datasets: [{
              label: 'Überstunden Gesamt',
              data: overtimeData,
              borderColor: globalChartColors.mediumGreen,
              backgroundColor: `${globalChartColors.mediumGreen}33`,
              tension: 0.4,
              fill: true
            }]
          },
          options: {
            responsive: true,
            maintainAspectRatio: false,
            scales: {
              y: {
                beginAtZero: true,
                ticks: {
                  callback: function(value) {
                    return value + ' Std';
                  }
                }
              }
            },
            plugins: { legend: { display: true, position: 'top' } }
          }
        });
      }
    }

    // Krankheitsverlauf (Admin/Manager)
    const adminSickCtx = document.getElementById('adminSicknessChart');
    if (adminSickCtx) {
      const monthLabels = {{.monthLabels}} || ['Jan', 'Feb', 'Mär', 'Apr', 'Mai', 'Jun', 'Jul', 'Aug', 'Sep', 'Okt', 'Nov', 'Dez'];
      const sicknessData = {{.sicknessTrend}} || [];

      if (sicknessData.length > 0) {
        new Chart(adminSickCtx.getContext('2d'), {
          type: 'bar',
          data: {
            labels: monthLabels,
            datasets: [{
              label: 'Krankmeldungen',
              data: sicknessData,
              backgroundColor: globalChartColors.darkGreen,
              borderColor: globalChartColors.darkGreen,
              borderWidth: 1,
              borderRadius: { topLeft: 8, topRight: 8, bottomLeft: 0, bottomRight: 0 },
              borderSkipped: 'bottom'
            }]
          },
          options: {
            responsive: true,
            maintainAspectRatio: false,
            scales: { y: { beginAtZero: true, ticks: { stepSize: 1, precision: 0 } } },
            plugins: { legend: { display: false } }
          }
        });
      }
    }

    // Abteilungsverteilung (Admin/Manager - KORRIGIERT)
    const adminDeptCtx = document.getElementById('adminDepartmentChart');
    if (adminDeptCtx) {
      const deptLabels = {{.departmentLabels}} || [];
      const deptData = {{.departmentData}} || [];

      console.log('Admin Department Chart - Labels:', deptLabels, 'Data:', deptData); // Debug

      if (isValidChartData(deptLabels, deptData)) {
        const chartColors = deptLabels.map((_, index) => globalChartColors.paletteCycle[index % globalChartColors.paletteCycle.length]);

        new Chart(adminDeptCtx.getContext('2d'), {
          type: 'doughnut',
          data: {
            labels: deptLabels,
            datasets: [{
              data: deptData,
              backgroundColor: chartColors,
              hoverOffset: 4
            }]
          },
          options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
              legend: { position: 'bottom' },
              tooltip: {
                callbacks: {
                  label: function(context) {
                    let label = context.label || '';
                    if (label) { label += ': '; }
                    if (context.parsed !== null) {
                      label += context.parsed;
                      label += ' Mitarbeiter';
                    }
                    return label;
                  }
                }
              }
            }
          }
        });
      } else {
        // Fallback wenn keine Daten vorhanden
        const ctx = adminDeptCtx.getContext('2d');
        ctx.font = '16px Arial';
        ctx.fillStyle = '#9CA3AF';
        ctx.textAlign = 'center';
        ctx.fillText('Keine Abteilungsdaten verfügbar', adminDeptCtx.width / 2, adminDeptCtx.height / 2);
      }
    }

    {{end}}
    // --- ENDE: Nur für Admin/Manager Rollen ---

    // --- BEGINN: Nur für HR Rolle ---
    {{if eq .userRole "hr"}}

    // Abteilungsverteilung-Diagramm (HR - KORRIGIERT)
    const hrDeptCtx = document.getElementById('hrDepartmentChart');
    if (hrDeptCtx) {
      const deptLabels = {{.departmentLabels}} || [];
      const deptData = {{.departmentData}} || [];

      console.log('HR Department Chart - Labels:', deptLabels, 'Data:', deptData); // Debug

      if (isValidChartData(deptLabels, deptData)) {
        const chartColors = deptLabels.map((_, index) => globalChartColors.paletteCycle[index % globalChartColors.paletteCycle.length]);

        new Chart(hrDeptCtx.getContext('2d'), {
          type: 'doughnut',
          data: {
            labels: deptLabels,
            datasets: [{
              data: deptData,
              backgroundColor: chartColors,
              hoverOffset: 4
            }]
          },
          options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
              legend: { position: 'bottom' },
              tooltip: {
                callbacks: {
                  label: function(context) {
                    let label = context.label || '';
                    if (label) { label += ': '; }
                    if (context.parsed !== null) {
                      label += context.parsed;
                      label += ' Mitarbeiter';
                    }
                    return label;
                  }
                }
              }
            }
          }
        });
      } else {
        // Fallback wenn keine Daten vorhanden
        const ctx = hrDeptCtx.getContext('2d');
        ctx.font = '16px Arial';
        ctx.fillStyle = '#9CA3AF';
        ctx.textAlign = 'center';
        ctx.fillText('Keine Abteilungsdaten verfügbar', hrDeptCtx.width / 2, hrDeptCtx.height / 2);
      }
    }

    // Status-Verteilung-Diagramm (HR)
    const hrStatusCtx = document.getElementById('hrStatusChart');
    if (hrStatusCtx) {
      const statusLabels = {{.statusLabels}} || [];
      const statusData = {{.statusData}} || [];

      if (isValidChartData(statusLabels, statusData)) {
        const statusColors = [
          globalChartColors.mediumGreen,
          globalChartColors.lightGreen,
          globalChartColors.darkGreen,
          globalChartColors.limeGreen
        ].slice(0, statusLabels.length);

        new Chart(hrStatusCtx.getContext('2d'), {
          type: 'pie',
          data: {
            labels: statusLabels,
            datasets: [{
              data: statusData,
              backgroundColor: statusColors,
              hoverOffset: 4
            }]
          },
          options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
              legend: { position: 'bottom' },
              tooltip: {
                callbacks: {
                  label: function(context) {
                    let label = context.label || '';
                    if (label) { label += ': '; }
                    if (context.parsed !== null) {
                      label += context.parsed;
                      label += ' Mitarbeiter';
                    }
                    return label;
                  }
                }
              }
            }
          }
        });
      }
    }

    // Altersverteilung-Diagramm (HR)
    const hrAgeCtx = document.getElementById('hrAgeChart');
    if (hrAgeCtx) {
      const ageLabels = {{.ageLabels}} || [];
      const ageData = {{.ageData}} || [];

      if (isValidChartData(ageLabels, ageData)) {
        new Chart(hrAgeCtx.getContext('2d'), {
          type: 'bar',
          data: {
            labels: ageLabels,
            datasets: [{
              label: 'Anzahl Mitarbeiter',
              data: ageData,
              backgroundColor: globalChartColors.mediumGreen,
              borderColor: globalChartColors.mediumGreen,
              borderWidth: 1,
              borderRadius: { topLeft: 8, topRight: 8, bottomLeft: 0, bottomRight: 0 },
              borderSkipped: 'bottom'
            }]
          },
          options: {
            responsive: true,
            maintainAspectRatio: false,
            scales: { y: { beginAtZero: true, ticks: { stepSize: 1, precision: 0 } } },
            plugins: { legend: { display: false } }
          }
        });
      }
    }

    // Krankheitsverlauf (HR)
    const hrSicknessCtx = document.getElementById('hrSicknessChart');
    if (hrSicknessCtx) {
      const monthLabels = ['Jan', 'Feb', 'Mär', 'Apr', 'Mai', 'Jun', 'Jul', 'Aug', 'Sep', 'Okt', 'Nov', 'Dez'];
      const sicknessData = {{.sicknessByMonthData}} || [];

      if (sicknessData.length > 0) {
        new Chart(hrSicknessCtx.getContext('2d'), {
          type: 'line',
          data: {
            labels: monthLabels,
            datasets: [{
              label: 'Krankheitstage',
              data: sicknessData,
              borderColor: globalChartColors.darkGreen,
              backgroundColor: `${globalChartColors.darkGreen}33`,
              fill: true,
              tension: 0.4
            }]
          },
          options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: { legend: { display: false } },
            scales: {
              y: {
                beginAtZero: true,
                ticks: {
                  stepSize: 1,
                  precision: 0,
                  callback: function(value) {
                    return value + ' Tage';
                  }
                }
              }
            }
          }
        });
      }
    }

    {{end}}
    // --- ENDE: Nur für HR Rolle ---

  });

  // Quick Approval Function für Überstunden-Anpassungen
  function approveAdjustment(adjustmentId, action) {
    const actionText = action === 'approve' ? 'genehmigen' : 'ablehnen';

    if (!confirm(`Möchten Sie diese Überstunden-Anpassung wirklich ${actionText}?`)) {
      return;
    }

    const formData = new FormData();
    formData.append('action', action);

    fetch(`/api/overtime/adjustments/${adjustmentId}/approve`, {
      method: 'POST',
      body: formData
    })
            .then(response => response.json())
            .then(data => {
              if (data.success) {
                // Success notification
                showNotification(data.message, 'success');
                // Reload page after short delay
                setTimeout(() => {
                  window.location.reload();
                }, 1500);
              } else {
                showNotification(data.error || 'Fehler beim Verarbeiten der Anfrage', 'error');
              }
            })
            .catch(error => {
              console.error('Error:', error);
              showNotification('Ein Fehler ist aufgetreten', 'error');
            });
  }

  // Quick Approval Function für Abwesenheitsanträge
  function approveAbsence(employeeId, absenceId, action) {
    const actionText = action === 'approve' ? 'genehmigen' : 'ablehnen';

    if (!confirm(`Möchten Sie diesen Abwesenheitsantrag wirklich ${actionText}?`)) {
      return;
    }

    // Note: This function currently uses placeholder IDs
    // You'll need to modify the template to pass the actual absence ID
    fetch(`/api/absence/${employeeId}/${absenceId}/${action}`, {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
      },
      body: JSON.stringify({
        action: action
      })
    })
            .then(response => response.json())
            .then(data => {
              if (data.success) {
                // Success notification
                showNotification(data.message, 'success');
                // Reload page after short delay
                setTimeout(() => {
                  window.location.reload();
                }, 1500);
              } else {
                showNotification(data.error || 'Fehler beim Verarbeiten der Anfrage', 'error');
              }
            })
            .catch(error => {
              console.error('Error:', error);
              showNotification('Ein Fehler ist aufgetreten', 'error');
            });
  }

  // Simple notification function
  function showNotification(message, type = 'info') {
    const notification = document.createElement('div');
    notification.className = `fixed top-4 right-4 z-50 p-4 rounded-lg shadow-lg max-w-sm ${
            type === 'success' ? 'bg-green-500 text-white' :
                    type === 'error' ? 'bg-red-500 text-white' :
                            'bg-blue-500 text-white'
    }`;
    notification.innerHTML = `
    <div class="flex items-center">
      <span class="flex-1">${message}</span>
      <button onclick="this.parentElement.parentElement.remove()" class="ml-2 text-white hover:text-gray-200">
        <svg class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
        </svg>
      </button>
    </div>
  `;

    document.body.appendChild(notification);

    // Auto-remove after 5 seconds
    setTimeout(() => {
      if (notification.parentNode) {
        notification.remove();
      }
    }, 5000);
  }
</script>
</body>
</html>